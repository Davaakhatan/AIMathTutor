# AI Math Tutor - Socratic Learning Assistant

An AI-powered math tutor that guides students through problem-solving using the Socratic method. Students learn by discovering solutions through guided questioning rather than receiving direct answers. All responses are dynamically generated by OpenAI's GPT-4, ensuring genuine AI-powered learning with no hardcoded responses.

## ğŸ“š Documentation

This project includes comprehensive documentation:

- **[ARCHITECTURE.md](./ARCHITECTURE.md)** - System architecture and technical design
- **[EXAMPLES.md](./EXAMPLES.md)** - Example walkthroughs demonstrating Socratic dialogue (10+ examples)
- **[PROMPT_ENGINEERING.md](./PROMPT_ENGINEERING.md)** - Prompt engineering approach and Socratic method implementation
- **[TESTING_GUIDE.md](./TESTING_GUIDE.md)** - Comprehensive testing guide for all problem types
- **[UTILITIES.md](./UTILITIES.md)** - Development utilities and tools guide
- **[VERCEL_SETUP.md](./VERCEL_SETUP.md)** - Quick Vercel deployment guide (fix API key errors)
- **[memory-bank/](./memory-bank/)** - Project memory bank with context and patterns

## ğŸ¯ Project Overview

Build an AI tutor that:
- Accepts math problems via text or image upload
- Engages students in Socratic dialogue to guide learning
- Maintains conversation context throughout the session
- Adapts to student understanding level
- Never provides direct answers, only guidance
- All responses powered by OpenAI GPT-4 (no hardcoded fallbacks)

## âœ¨ Features

### Core Features âœ…

- **Problem Input**
  - Text entry with validation
  - Image upload with drag-and-drop
  - OpenAI Vision API for OCR and problem parsing
  - Support for printed and handwritten text
  - Automatic problem type detection

- **Socratic Dialogue**
  - Multi-turn conversation with context management
  - Never provides direct answers - only guiding questions
  - Progressive hint system (4 levels)
  - Adaptive scaffolding based on student understanding
  - Intelligent completion detection

- **Math Rendering**
  - LaTeX/KaTeX support for equations
  - Inline and block math formatting
  - Proper equation display

- **Web Interface**
  - Clean, minimalist chat UI
  - Mobile responsive design
  - Conversation history
  - Real-time progress tracking
  - Session persistence (survives hot reloads)

### Stretch Features âœ…

- **Step Visualization** - Animated breakdown of solution steps
- **Voice Interface** - Text-to-speech (natural human voice) + speech-to-text input
- **Interactive Whiteboard** - Shared canvas for visual explanations
- **Difficulty Modes** - Adjust scaffolding by grade level (Elementary, Middle School, High School, Advanced)
- **Problem Generation** - AI-powered problem generation with difficulty selection

### Learning Features âœ…

- **Problem History** - Save and search through past problems
- **Bookmarks** - Bookmark favorite problems for quick access
- **Learning Dashboard** - Track progress, time spent, problems by type
- **Study Streak** - Track consecutive days of study
- **Achievements** - Earn badges for milestones
- **Study Reminders** - Customizable study notifications
- **Problem Suggestions** - AI suggests problem types to practice
- **Formula Reference** - Quick access to common math formulas
- **Practice Mode** - One-click random problem generation
- **Progress Tracking** - Intelligent progress detection with completion recognition

### Additional Features âœ…

- **Settings Panel** - Customize voice, font size, auto-save, API key
- **Keyboard Shortcuts** - Efficient navigation and actions
- **Conversation Export** - Export conversations for review
- **Print View** - Print-friendly conversation layout
- **Error Recovery** - Graceful error handling with retry options
- **Offline Indicator** - Network status awareness
- **Accessibility** - Full keyboard navigation, ARIA labels, screen reader support

## ğŸš€ Quick Start

### Prerequisites
- Node.js 18+ (recommended: Node.js 20+)
- npm or yarn
- OpenAI API key (get from https://platform.openai.com/api-keys)

### Setup Instructions

1. **Clone or navigate to the project directory**
   ```bash
   cd AITutor
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Set up environment variables**
   ```bash
   # Create .env.local file
   touch .env.local
   ```
   
   Add the following to `.env.local`:
   ```env
   OPENAI_API_KEY=your_openai_api_key_here
   ```
   
   **Note**: Make sure there are no leading/trailing spaces in your API key!

4. **Run development server**
   ```bash
   # Standard dev server
   npm run dev
   
   # Or use the start script (stops any existing process on port 3002)
   ./start
   ```
   
   The start script (`./start`) will:
   - Stop any process running on port 3002
   - Start the dev server on port 3002
   - Ensure `.env.local` is reloaded

5. **Open in browser**
   - Navigate to [http://localhost:3002](http://localhost:3002) (or port shown in terminal)

### Building for Production

```bash
# Build the application
npm run build

# Start production server
npm start
```

### API Key Management

The app supports multiple ways to provide your OpenAI API key:

1. **Environment Variable** (Recommended for local development)
   - Add to `.env.local`: `OPENAI_API_KEY=sk-your-key`
   - Restart dev server after adding/changing

2. **Settings Panel** (Fallback for deployed apps)
   - Open Settings (gear icon)
   - Enter API key in the input field
   - Key is stored in browser localStorage
   - Works as fallback when environment variable is not available

3. **Deployment** (AWS Amplify, Vercel, etc.)
   - Add `OPENAI_API_KEY` to environment variables in your deployment platform
   - No need to set it in Settings panel

## ğŸŒ Deployment

### Vercel

See [VERCEL_SETUP.md](./VERCEL_SETUP.md) for detailed instructions.

Quick steps:
1. Push code to GitHub
2. Import project in Vercel
3. Add `OPENAI_API_KEY` to environment variables
4. Deploy

### AWS Amplify

1. Connect GitHub repository to AWS Amplify
2. Add `OPENAI_API_KEY` to environment variables:
   - Go to App Settings â†’ Environment Variables
   - Add `OPENAI_API_KEY` with your key value
3. Deploy

### Docker

A `Dockerfile` is included for containerized deployments:

```bash
docker build -t ai-math-tutor .
docker run -p 3000:3000 -e OPENAI_API_KEY=your_key ai-math-tutor
```

## ğŸ“– Example Interaction

```
Student: [uploads "2x + 5 = 13"]
Tutor: "What are we trying to find?"
Student: "x"
Tutor: "Right! To get x alone, we need to undo the +5 and Ã—2. Which should we undo first?"
Student: "the +5?"
Tutor: "Exactly! How do we undo adding 5?"
Student: "subtract 5"
Tutor: "Perfect! So what happens when we subtract 5 from both sides?"
```

## ğŸ§ª Testing

### Quick Test
```bash
# Start dev server
npm run dev

# Or use start script
./start

# Open http://localhost:3002
```

### Comprehensive Testing
- **[TESTING_GUIDE.md](./TESTING_GUIDE.md)** - Core features testing
- Test various problem types: arithmetic, algebra, geometry, word problems, multi-step

### Test Scripts
```bash
# Test all problem types
npm run test:all

# Test specific type
npm run test:type arithmetic

# Test parsing
npm run test:parse "2x + 5 = 13"

# Test chat
npm run test:chat "2x + 5 = 13"
```

## ğŸ—ï¸ Architecture

See [ARCHITECTURE.md](./ARCHITECTURE.md) for detailed system design.

**Tech Stack**:
- **Frontend**: Next.js 14, React 18, Tailwind CSS, KaTeX
- **Backend**: Next.js API Routes
- **LLM**: OpenAI GPT-4 (Vision + Dialogue)
- **State Management**: React hooks, localStorage
- **Deployment**: Vercel, AWS Amplify, Docker

**Key Components**:
- `services/problemParser.ts` - Parse problems from text/images
- `services/dialogueManager.ts` - Orchestrate conversations
- `services/contextManager.ts` - Manage session context (with global storage for dev mode)
- `services/socraticPromptEngine.ts` - Generate Socratic prompts
- `components/chat/ChatUI.tsx` - Main chat interface
- `components/ProblemHistory.tsx` - Problem history and bookmarks
- `components/LearningDashboard.tsx` - Learning analytics

## ğŸ“ Socratic Approach

The system follows these principles:
1. **Never give direct answers** - Only guide through questions
2. **Progressive disclosure** - Start broad, narrow to specifics
3. **Adaptive scaffolding** - Increase hints if stuck >2 turns
4. **Encouraging language** - Positive reinforcement throughout
5. **Completion recognition** - Detect when student solves the problem and celebrate

All responses are dynamically generated by OpenAI GPT-4 using carefully crafted Socratic prompts. There are no hardcoded responses or fallbacks.

## ğŸ”§ Troubleshooting

**Issue: OpenAI API errors**
- Verify your API key is correct in `.env.local` (no leading/trailing spaces)
- Check your OpenAI account has sufficient credits
- Ensure the API key has access to GPT-4 models
- Try entering the API key in Settings panel as fallback
- Restart dev server after changing `.env.local`

**Issue: Sessions disappearing**
- Fixed: Sessions now persist across hot reloads using global storage
- If issues persist, check browser console for errors

**Issue: Progress shows "Solved!" incorrectly**
- Fixed: Progress detection now uses definitive completion phrases
- Only shows "Solved!" when tutor explicitly confirms completion

**Issue: Image parsing not working**
- Ensure images are in JPG or PNG format
- Check file size is under 10MB
- Verify OpenAI Vision API access

**Issue: Math equations not rendering**
- Check browser console for errors
- Ensure KaTeX CSS is loaded
- Verify LaTeX syntax in responses

**Issue: API key not working in deployed app**
- Check environment variables are set in deployment platform
- Use Settings panel to enter API key as fallback
- Verify API key format (should start with `sk-` or `sk-proj-`)

## ğŸ¯ Recent Improvements

- âœ… Session persistence across Next.js hot reloads
- âœ… Intelligent progress detection with completion recognition
- âœ… Enhanced bookmark functionality with search and filtering
- âœ… Panel z-index fixes for proper layering
- âœ… All responses from OpenAI (no hardcoded fallbacks)
- âœ… Improved error handling and user feedback
- âœ… Text normalization for better problem display
- âœ… API key management with multiple fallback options

## ğŸ¤ Contributing

This is a project for SuperBuilders. See project documentation for details.

## ğŸ“§ Contact

John Chen - john.chen@superbuilders.school

## ğŸ“„ License

[Add license information]

---

**Reference**: Inspired by OpenAI x Khan Academy demo: https://www.youtube.com/watch?v=IvXZCocyU_M

**Built with**: Next.js, React, OpenAI GPT-4, Tailwind CSS, KaTeX
